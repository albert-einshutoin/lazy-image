# v0.10.0 ãƒªãƒªãƒ¼ã‚¹ãƒ—ãƒ©ãƒ³

## ãƒ–ãƒ©ãƒ³ãƒæˆ¦ç•¥ï¼ˆGit Flowï¼‰

ã“ã®ãƒ—ãƒ©ãƒ³ã¯ **Git Flow** ã‚’å‰æã¨ã™ã‚‹ã€‚

- **develop**: é–‹ç™ºã®ãƒ™ãƒ¼ã‚¹ã€‚é€šå¸¸ã® PR ã¯ develop ã«ãƒžãƒ¼ã‚¸ã™ã‚‹ã€‚
- **release/v0.10.0**: develop ã‹ã‚‰åˆ†å²ã€‚CHANGELOG æ›´æ–°ãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 0.10.0 ã¸ã®æ›´æ–°ã®ã¿è¡Œã†ã€‚ãƒªãƒªãƒ¼ã‚¹æº–å‚™å°‚ç”¨ã€‚
- **main**: æœ¬ç•ªãƒªãƒªãƒ¼ã‚¹ç”¨ã€‚release/v0.10.0 ã‚’ main ã«ãƒžãƒ¼ã‚¸ã—ã€main ä¸Šã§ã‚¿ã‚° `v0.10.0` ã‚’æ‰“ã£ã¦ push ã™ã‚‹ã€‚
- **ãƒªãƒªãƒ¼ã‚¹å¾Œ**: release/v0.10.0 ã‚’ develop ã«ãƒžãƒ¼ã‚¸ã—ã€develop ã«ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã‚’åæ˜ ã™ã‚‹ï¼ˆã¾ãŸã¯ main ã‚’ develop ã«ãƒžãƒ¼ã‚¸ã™ã‚‹ï¼‰ã€‚

---

## ç¾çŠ¶

- **ç¾åœ¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³**: 0.9.0ï¼ˆ[package.json](../../package.json) / [Cargo.toml](../../Cargo.toml)ï¼‰
- **CHANGELOG**: [Unreleased] ã« v0.10.0 å€™è£œã®å¤‰æ›´ãŒå¤šæ•°è¨˜è¼‰æ¸ˆã¿ï¼ˆEXIF ä¿æŒã€Extract èžåˆã€ãƒ¡ãƒˆãƒªã‚¯ã‚¹éžæŽ¨å¥¨ã€processBatch ã‚ªãƒ—ã‚·ãƒ§ãƒ³ã‚ªãƒ–ã‚¸ã‚§ã‚¯ãƒˆã€normalizePixelFormat ãªã©ï¼‰
- **å…¬é–‹ãƒˆãƒªã‚¬ãƒ¼**: ã‚¿ã‚° `v*` ã® push ã¾ãŸã¯æ‰‹å‹• `workflow_dispatch` ã§ [CI ã® publish ã‚¸ãƒ§ãƒ–](../../.github/workflows/CI.yml) ãŒå®Ÿè¡Œã•ã‚Œã€ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ã¨ 6 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ãŒ npm ã«å…¬é–‹ã•ã‚Œã‚‹

## ãƒªãƒªãƒ¼ã‚¹æ‰‹é †

### 1. ãƒªãƒªãƒ¼ã‚¹å‰ãƒã‚§ãƒƒã‚¯

- **develop ã®çŠ¶æ…‹**: ãƒªãƒªãƒ¼ã‚¹ã«å«ã‚ãŸã„å¤‰æ›´ãŒã™ã¹ã¦ develop ã«ãƒžãƒ¼ã‚¸ã•ã‚Œã¦ã„ã‚‹ã“ã¨
- **CI**: develop ã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆãƒ»å“è³ªã‚¸ãƒ§ãƒ–ãŒé€šã£ã¦ã„ã‚‹ã“ã¨
- **CHANGELOG**: [Unreleased] ã®å†…å®¹ãŒ v0.10.0 ã¨ã—ã¦å•é¡Œãªã„ã‹æœ€çµ‚ç¢ºèªï¼ˆç ´å£Šçš„å¤‰æ›´ã®æœ‰ç„¡ã¯ [docs/SEMVER_POLICY.md](../SEMVER_POLICY.md) ã«å¾“ã†ï¼‰

### 2. release ãƒ–ãƒ©ãƒ³ãƒã‚’åˆ‡ã‚‹

develop ã‹ã‚‰ **release/v0.10.0** ã‚’åˆ†å²ã™ã‚‹ã€‚

```powershell
git checkout develop
git pull origin develop
git checkout -b release/v0.10.0
```

ä»¥é™ã® step 3ã€œ5 ã®ä½œæ¥­ï¼ˆREADMEãƒ»CHANGELOGãƒ»ãƒãƒ¼ã‚¸ãƒ§ãƒ³æ›´æ–°ãƒ»ã‚³ãƒŸãƒƒãƒˆï¼‰ã¯ **release/v0.10.0** ä¸Šã§è¡Œã†ã€‚

### 3. README.md ã®ä¿®æ­£ï¼ˆPerformance & Trade-offsï¼‰

[README.md](../../README.md) ã‚’ã€æä¾›ã•ã‚ŒãŸ **Performance & Trade-offs: lazy-image vs sharp** ã®å†…å®¹ã«åŸºã¥ãä¿®æ­£ã™ã‚‹ã€‚release ãƒ–ãƒ©ãƒ³ãƒä¸Šã§å®Ÿæ–½ã™ã‚‹ã€‚

**ç½®ãæ›ãˆå¯¾è±¡**: æ—¢å­˜ã® **ã€Œ## ðŸ“Š Benchmark Resultsã€**ï¼ˆ72è¡Œç›®ä»˜è¿‘ï¼‰ã‹ã‚‰ **ã€Œ## âš¡ Featuresã€ã®ç›´å‰**ï¼ˆ168è¡Œç›®ä»˜è¿‘ï¼‰ã¾ã§ã‚’ã€ä»¥ä¸‹ã®æ–°ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã§ç½®ãæ›ãˆã‚‹ã€‚

**è¿½åŠ ã™ã‚‹è¦‹å‡ºã—ã¨å†…å®¹**:

1. **## âš–ï¸ Performance & Trade-offs: lazy-image vs sharp**
  - å°Žå…¥æ–‡: radical transparencyã€Cloud-Native efficiencyã€Linux/x64 ãƒ™ãƒ³ãƒã®èª¬æ˜Žã€‚
2. **### ðŸ“Š Benchmark Summary (Large Image 5000x5000px)**
  - 5 è¡Œã®è¡¨ï¼ˆFeature | Metric | lazy-image | sharp | The Verdictï¼‰:
    - AVIF Generation: Time â€” lazy-image 13.3s, sharp 47.4s â†’ Lazy-image ~3.5x Faster
    - JPEG Compression: File Size â€” lazy-image 1.1 MB, sharp 1.5 MB â†’ ~26% bandwidth save
    - JPEG Encoding: Speed â€” lazy-image 1.2s, sharp 0.3s â†’ Sharp ~4x Faster
    - Memory Safety: Peak RSS â€” lazy-image 713 MB, sharp 2,416 MB â†’ ~70% less memory
    - WebP Resize: Speed â€” lazy-image 320ms, sharp 134ms â†’ Sharp ~2.5x Faster
  - å¼•ç”¨: *Full benchmark data is available in [TRUE_BENCHMARKS.md](../TRUE_BENCHMARKS.md).*
3. **### ðŸ¤” Which one should I choose?**
  - **Choose lazy-image if:** Serverless / Bandwidth / AVIF / Safety ã® 4 é …ç›®ï¼ˆç®‡æ¡æ›¸ãï¼‰ã€‚
  - **Choose sharp if:** Persistent Servers / Throughput / No AVIF ã® 3 é …ç›®ï¼ˆç®‡æ¡æ›¸ãï¼‰ã€‚
4. **### ðŸ’¡ Our Philosophy**
  - çŸ­æ–‡: Slow to encode, Fast to loadï¼›æœ€å¤§åœ§ç¸®çŽ‡ã¨ãƒ¡ãƒ¢ãƒªå®‰å®šæ€§ã‚’å„ªå…ˆã€‚

README ã®å¤‰æ›´ã‚’ **release/v0.10.0** ä¸Šã§ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ï¼ˆCHANGELOG ã¨åŒä¸€ã‚³ãƒŸãƒƒãƒˆã§ã‚‚ã€åˆ¥ã‚³ãƒŸãƒƒãƒˆã§ã‚‚ã‚ˆã„ï¼‰ã€‚

### 4. CHANGELOG ã‚’ v0.10.0 ç”¨ã«æ›´æ–°

[CHANGELOG.md](../../CHANGELOG.md) ã‚’ç·¨é›†ã™ã‚‹:

- **è¦‹å‡ºã—**: `## [Unreleased]` ã®ç›´å¾Œã« `## [0.10.0] - YYYY-MM-DD` ã‚’è¿½åŠ ï¼ˆãƒªãƒªãƒ¼ã‚¹æ—¥ã¯ä½œæ¥­æ—¥ã¾ãŸã¯äºˆå®šæ—¥ï¼‰
- **å†…å®¹**: ã“ã‚Œã¾ã§ [Unreleased] ã«æ›¸ã„ã¦ã„ãŸ v0.10.0 ã®å¤‰æ›´ã‚’ã™ã¹ã¦ `[0.10.0]` ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã«ç§»å‹•ã™ã‚‹
- **Unreleased**: `## [Unreleased]` ã¯ç©ºã®ã¾ã¾æ®‹ã™ï¼ˆä»Šå¾Œã®å¤‰æ›´ç”¨ï¼‰
- **CHANGELOG æœ«å°¾ã®ãƒªãƒ³ã‚¯**ï¼ˆå¿…é ˆï¼‰: [CHANGELOG.md](../../CHANGELOG.md) æœ«å°¾ã® Keep a Changelog ãƒªãƒ³ã‚¯ã‚’æ›´æ–°ã™ã‚‹ã€‚`[Unreleased]: ...v0.9.0...HEAD` ã‚’ `...v0.10.0...HEAD` ã«å¤‰æ›´ã—ã€`[0.10.0]: https://github.com/albert-einshutoin/lazy-image/compare/v0.9.0...v0.10.0` ã‚’ `[0.9.0]` ã®ç›´å‰ã«è¿½åŠ ã™ã‚‹

CHANGELOG ã®å¤‰æ›´ã‚’ **release/v0.10.0** ä¸Šã§ã‚³ãƒŸãƒƒãƒˆã™ã‚‹ã€‚

### 5. ãƒãƒ¼ã‚¸ãƒ§ãƒ³ã‚’ 0.10.0 ã«ä¸Šã’ã¦åŒæœŸ

**å‰æ**: step 3ï¼ˆREADMEï¼‰ã¨ step 4ï¼ˆCHANGELOGï¼‰ã®å¤‰æ›´ã¯ã“ã®å‰ã« **ã‚³ãƒŸãƒƒãƒˆæ¸ˆã¿**ã«ã™ã‚‹ã“ã¨ã€‚`npm version` ã¯ä½œæ¥­ãƒ„ãƒªãƒ¼ãŒã‚¯ãƒªãƒ¼ãƒ³ã§ã‚ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚

æ¬¡ã®ã„ãšã‚Œã‹ã§å®Ÿæ–½ã€‚

**æ–¹æ³• Aï¼ˆæŽ¨å¥¨ï¼‰: npm ã® version ã‚³ãƒžãƒ³ãƒ‰**

```powershell
npm version 0.10.0 -m "Release v0.10.0"
```

- `package.json` ã® `version` ãŒ 0.10.0 ã«æ›´æ–°ã•ã‚Œã‚‹
- `npm version` å®Ÿè¡Œæ™‚ã« `scripts.version` ãŒèµ°ã‚‹ãŸã‚ã€[scripts/sync-version.js](../../scripts/sync-version.js) ãŒå®Ÿè¡Œã•ã‚Œã€**Cargo.toml**ãƒ»**package-lock.json**ãƒ»**optionalDependencies** ãŒ 0.10.0 ã«åŒæœŸã•ã‚Œã‚‹
- åŒæ™‚ã« git ã§ `v0.10.0` ã‚¿ã‚°ãŒä½œæˆã•ã‚Œã‚‹ï¼ˆãƒ¡ãƒƒã‚»ãƒ¼ã‚¸ã¯ä¸Šè¨˜ `-m` ã®å†…å®¹ï¼‰
- **é‡è¦**: `npm version` ãŒã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã‚‹ã®ã¯ **package.json ã¨ package-lock.json ã®ã¿**ï¼ˆnpm ã®ä»•æ§˜ï¼‰ã€‚`sync-version.js` ã¯ **Cargo.toml** ã‚‚æ›¸ãæ›ãˆã‚‹ãŒã€Cargo.toml ã¯ npm ãŒçŸ¥ã‚‰ãªã„ãŸã‚ **è‡ªå‹•ã§ã¯ã‚³ãƒŸãƒƒãƒˆã•ã‚Œãªã„**ã€‚æ–¹æ³• A ã‚’ä½¿ã†å ´åˆã¯ **`npm version` ã®ç›´å¾Œã« `git status` ã§ç¢ºèªã—ã€Cargo.toml ãŒå¤‰æ›´ã•ã‚Œã¦ã„ã‚Œã° `git add Cargo.toml && git commit --amend --no-edit` ã§ã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã¦ã‹ã‚‰ push ã™ã‚‹ã“ã¨**ã€‚ã•ã‚‚ãªã„ã¨ã‚¿ã‚°ã®æŒ‡ã™ã‚³ãƒŸãƒƒãƒˆã« Cargo.toml ã® 0.10.0 ãŒå«ã¾ã‚Œãšã€CI ã§ãƒ“ãƒ«ãƒ‰ã•ã‚Œã‚‹ Cargo.toml ãŒ 0.9.0 ã®ã¾ã¾ã«ãªã‚‹ã€‚
- **lock ãƒ•ã‚¡ã‚¤ãƒ«**: `sync-version.js` ã¯ **package-lock.json** ã‚‚æ›´æ–°ã™ã‚‹ã€‚package-lock.json ã¯ `npm version` ã«ã‚ˆã£ã¦ã‚³ãƒŸãƒƒãƒˆã«å«ã¾ã‚Œã‚‹ã€‚Cargo.lock ã¯ sync-version.js ã§ã¯è§¦ã‚‰ãªã„ãŒã€å¤‰æ›´ãŒã‚ã‚Œã°ã‚³ãƒŸãƒƒãƒˆã«å«ã‚ã‚‹ã€‚

**æ–¹æ³• B: æ‰‹å‹•ã§ä¸Šã’ã¦ã‹ã‚‰åŒæœŸ**

1. [package.json](../../package.json) ã® `"version": "0.9.0"` ã‚’ `"0.10.0"` ã«å¤‰æ›´
2. `npm run version` ã‚’å®Ÿè¡Œã—ã¦ Cargo.toml / package-lock.json / optionalDependencies ã‚’åŒæœŸ
3. ã‚³ãƒŸãƒƒãƒˆå¾Œã«ã‚¿ã‚°ã‚’æ‰“ã¤: `git tag v0.10.0 -m "Release v0.10.0"`

### 6. main ã«ãƒžãƒ¼ã‚¸ã—ã¦ã‚¿ã‚°ã‚’ pushï¼ˆGit Flowï¼‰

- ãƒªãƒªãƒ¼ã‚¹ç”¨ã‚³ãƒŸãƒƒãƒˆã«ã¯ **package.json / Cargo.toml / package-lock.json** ã®ãƒãƒ¼ã‚¸ãƒ§ãƒ³å¤‰æ›´ã‚’ã™ã¹ã¦å«ã‚ã‚‹ï¼ˆæ–¹æ³• A ã®å ´åˆã¯ Cargo.toml ã® amend ã‚’å¿˜ã‚Œãªã„ï¼‰ã€‚
- **release/v0.10.0** ã‚’ **main** ã«ãƒžãƒ¼ã‚¸ã™ã‚‹ã€‚ãƒžãƒ¼ã‚¸ã¯ fast-forward ã§ã‚‚ã‚ˆã„ã—ã€`--no-ff` ã§ã€ŒRelease v0.10.0ã€ã®ã‚ˆã†ãªãƒžãƒ¼ã‚¸ã‚³ãƒŸãƒƒãƒˆã«ã—ã¦ã‚‚ã‚ˆã„ã€‚
- **main** ã«ãƒã‚§ãƒƒã‚¯ã‚¢ã‚¦ãƒˆã—ã€**main ã®å…ˆé ­**ã«ã‚¿ã‚° `v0.10.0` ãŒã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ï¼ˆrelease ãƒ–ãƒ©ãƒ³ãƒã§ `npm version` ã—ãŸå ´åˆã¯ã‚¿ã‚°ã¯ release å´ã®ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã—ã¦ã„ã‚‹ã€‚main ã«ãƒžãƒ¼ã‚¸ã—ãŸã‚ã¨ã€main ãŒãã®ã‚³ãƒŸãƒƒãƒˆã‚’å«ã‚“ã§ã„ã‚Œã°ã‚¿ã‚°ã¯ main ã‹ã‚‰å‚ç…§ã§ãã‚‹ï¼‰ã€‚
- main ã¨ã‚¿ã‚°ã‚’ push ã™ã‚‹ã€‚

```powershell
git checkout main
git pull origin main
git merge release/v0.10.0
git push origin main
git push origin v0.10.0
```

**æ³¨æ„**: `npm version` ã§ã‚¿ã‚°ã‚’æ‰“ã£ãŸå ´åˆã€ã‚¿ã‚°ã¯ release/v0.10.0 ã®ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã™ã€‚ãã®ã‚³ãƒŸãƒƒãƒˆã‚’ main ã«ãƒžãƒ¼ã‚¸ã™ã‚Œã°ã€push ã™ã‚‹ã‚¿ã‚°ã¯åŒã˜ã‚³ãƒŸãƒƒãƒˆã‚’æŒ‡ã™ã®ã§å•é¡Œãªã„ã€‚

### 7. develop ã«ãƒªãƒªãƒ¼ã‚¹å†…å®¹ã‚’æˆ»ã™ï¼ˆGit Flowï¼‰

release/v0.10.0 ã‚’ **develop** ã«ãƒžãƒ¼ã‚¸ã—ã€develop ã« CHANGELOG ã¨ãƒãƒ¼ã‚¸ãƒ§ãƒ³ 0.10.0 ã®å¤‰æ›´ã‚’åæ˜ ã™ã‚‹ã€‚

```powershell
git checkout develop
git pull origin develop
git merge release/v0.10.0
git push origin develop
```

ï¼ˆmain ã‚’ develop ã«ãƒžãƒ¼ã‚¸ã™ã‚‹é‹ç”¨ã§ã‚‚ã‚ˆã„ã€‚ã„ãšã‚Œã«ã›ã‚ˆ develop ã®å…ˆé ­ãŒ 0.10.0 ã®çŠ¶æ…‹ã«ãªã‚‹ã‚ˆã†ã«ã™ã‚‹ã€‚ï¼‰

### 8. CI ã«ã‚ˆã‚‹å…¬é–‹ç¢ºèª

- ã‚¿ã‚° `v0.10.0` ã® push ã§ [.github/workflows/CI.yml](../../.github/workflows/CI.yml) ãŒèµ·å‹•ã™ã‚‹
- **build** â†’ **test** ãŒæˆåŠŸã—ãŸã‚ã¨ã€**Publish to npm** ã‚¸ãƒ§ãƒ–ãŒå®Ÿè¡Œã•ã‚Œã‚‹ï¼ˆ`if: startsWith(github.ref, 'refs/tags/v')`ï¼‰
- ã‚¸ãƒ§ãƒ–å†…ã§ 6 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ç”¨ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ï¼ˆdarwin-x64, darwin-arm64, win32-x64-msvc, linux-x64-gnu, linux-arm64-gnu, linux-x64-muslï¼‰ãŒå…ˆã«å…¬é–‹ã•ã‚Œã€ç¶šã„ã¦ãƒ¡ã‚¤ãƒ³ãƒ‘ãƒƒã‚±ãƒ¼ã‚¸ `@alberteinshutoin/lazy-image` ãŒå…¬é–‹ã•ã‚Œã‚‹
- **å‰æ**: GitHub ã® NPM_TOKEN ã¾ãŸã¯ Trusted Publisher ãŒè¨­å®šæ¸ˆã¿ã§ã‚ã‚‹ã“ã¨

### 9. ãƒªãƒªãƒ¼ã‚¹å¾Œã®ç¢ºèª

- npm: `npm view @alberteinshutoin/lazy-image version` ãŒ `0.10.0` ã§ã‚ã‚‹ã“ã¨
- GitHub: ã‚¿ã‚° `v0.10.0` ã‹ã‚‰ Release ã‚’ä½œæˆã™ã‚‹å ´åˆã¯ã€GitHub ã® Releases ãƒšãƒ¼ã‚¸ã§ã€ŒDraft a new releaseã€â†’ ã‚¿ã‚° `v0.10.0` ã‚’é¸ã³ã€CHANGELOG ã® [0.10.0] ã‚»ã‚¯ã‚·ãƒ§ãƒ³ã‚’ã‚³ãƒ”ãƒ¼ã—ã¦èª¬æ˜Žæ–‡ã«è²¼ã‚Šä»˜ã‘ã¦å…¬é–‹

---

## æ³¨æ„äº‹é …

- **prepublishOnly**: ãƒ­ãƒ¼ã‚«ãƒ«ã§ `npm publish` ã‚’å©ãã¨ `napi prepublish --skip-gh-release` ãŒèµ°ã‚Šã¾ã™ã€‚é€šå¸¸ã®ãƒªãƒªãƒ¼ã‚¹ã¯ CI ã® publish ã‚¸ãƒ§ãƒ–ã«ä»»ã›ã‚‹ãŸã‚ã€ãƒ­ãƒ¼ã‚«ãƒ«ã§ publish ã™ã‚‹å¿…è¦ã¯ã‚ã‚Šã¾ã›ã‚“ã€‚
- **ãƒ–ãƒ©ãƒ³ãƒ**: æœ¬ãƒ—ãƒ©ãƒ³ã¯ **Git Flow** ã‚’æŽ¡ç”¨ã—ã€**release/v0.10.0** ã§ãƒªãƒªãƒ¼ã‚¹æº–å‚™ã‚’è¡Œã„ã€main ã«ãƒžãƒ¼ã‚¸ã—ã¦ã‚¿ã‚°ã‚’æ‰“ã£ãŸã‚ã¨ develop ã«ãƒžãƒ¼ã‚¸ã—æˆ»ã™æµã‚Œã¨ã™ã‚‹ã€‚
- **SEMVER**: v0.9 â†’ v0.10 ã¯ MINOR  bump ã§ã™ã€‚[docs/SEMVER_POLICY.md](../SEMVER_POLICY.md) ã«å¾“ã„ã€å¾Œæ–¹äº’æ›ã®è¿½åŠ ãƒ»æ”¹å–„ã®ã¿ãŒå«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã—ã¦ãã ã•ã„ã€‚ç ´å£Šçš„å¤‰æ›´ãŒã‚ã‚‹å ´åˆã¯ MAJOR ã«ã™ã‚‹ã‹ã€éžæŽ¨å¥¨ãƒ—ãƒ­ã‚»ã‚¹ã‚’çµŒã¦ã‹ã‚‰æ¬¡ MAJOR ã§å‰Šé™¤ã™ã‚‹æ–¹é‡ã§ã™ã€‚

---

## ã‚»ãƒ«ãƒ•ãƒ¬ãƒ“ãƒ¥ãƒ¼ãƒ»æ³¨æ„ç‚¹ï¼ˆCIãƒ»é‹ç”¨ï¼‰

### CI ãƒˆãƒªã‚¬ãƒ¼ã¨ publish æ¡ä»¶

- **ãƒˆãƒªã‚¬ãƒ¼**: [.github/workflows/CI.yml](../../.github/workflows/CI.yml) ã¯ `push`ï¼ˆmain / ã‚¿ã‚° `v*`ï¼‰ã€`pull_request`ã€`workflow_dispatch` ã§èµ·å‹•ã™ã‚‹ã€‚ã‚¿ã‚° `v0.10.0` ã‚’ push ã™ã‚‹ã¨ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼ãŒèµ°ã‚Šã€**ãã®ã‚¿ã‚°ãŒæŒ‡ã™ã‚³ãƒŸãƒƒãƒˆ**ã®ã‚³ãƒ¼ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ãƒ»ãƒ†ã‚¹ãƒˆãƒ»publish ãŒè¡Œã‚ã‚Œã‚‹ã€‚ãã®ãŸã‚ã€ã‚¿ã‚°ã‚’æ‰“ã¤å‰ã« **ãã®ã‚³ãƒŸãƒƒãƒˆã« package.json / Cargo.toml / package-lock.json / CHANGELOG ã® 0.10.0 å¤‰æ›´ãŒã™ã¹ã¦å«ã¾ã‚Œã¦ã„ã‚‹ã“ã¨**ã‚’ç¢ºèªã™ã‚‹ã€‚
- **publish ã® needs**: publish ã‚¸ãƒ§ãƒ–ã¯ **build** ã¨ **test** ã«ã®ã¿ä¾å­˜ã—ã¦ã„ã‚‹ã€‚**quality**ï¼ˆgolden / quality-metrics / test:bench:verifyï¼‰ã‚„ **supply-chain** / **coverage** / **leak-detection** ã¯ publish ã®æ¡ä»¶ã«å…¥ã£ã¦ã„ãªã„ã€‚ãƒªãƒªãƒ¼ã‚¹å‰ã« **quality ã‚‚é€šã£ã¦ã„ã‚‹ã“ã¨**ã‚’æ‰‹å‹•ã§ç¢ºèªã™ã‚‹ã“ã¨ã‚’æŽ¨å¥¨ã™ã‚‹ï¼ˆmain ã¾ãŸã¯ develop ã§ CI ãŒã™ã¹ã¦ç·‘ã§ã‚ã‚‹ã“ã¨ï¼‰ã€‚
- **workflow_dispatch**: æ‰‹å‹•å®Ÿè¡Œã§ publish ã™ã‚‹å ´åˆã€**å®Ÿè¡Œæ™‚ç‚¹ã® refï¼ˆé€šå¸¸ã¯ default ãƒ–ãƒ©ãƒ³ãƒï¼‰ã®ã‚³ãƒ¼ãƒ‰**ãŒä½¿ã‚ã‚Œã‚‹ã€‚ã‚¿ã‚° push ã¨é•ã£ã¦ã€Œç‰¹å®šã‚¿ã‚°ã®ã‚³ãƒŸãƒƒãƒˆã€ã§ã¯ãªã„ãŸã‚ã€main ã® package.json ãŒ 0.10.0 ã§ã‚ã‚‹ã“ã¨ã‚’äº‹å‰ã«ç¢ºèªã™ã‚‹ã“ã¨ã€‚

### ãƒ“ãƒ«ãƒ‰ãƒ»å…¬é–‹ã®å‰æ

- **6 ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ å¿…é ˆ**: publish ã‚¸ãƒ§ãƒ–ã¯ `required_platforms`ï¼ˆdarwin-x64, darwin-arm64, win32-x64-msvc, linux-x64-gnu, linux-arm64-gnu, linux-x64-muslï¼‰ãŒã™ã¹ã¦æƒã£ã¦ã„ãªã„ã¨å¤±æ•—ã™ã‚‹ã€‚build ãƒžãƒˆãƒªã‚¯ã‚¹ã®ã„ãšã‚Œã‹ãŒå¤±æ•—ã™ã‚‹ã¨ã‚¢ãƒ¼ãƒ†ã‚£ãƒ•ã‚¡ã‚¯ãƒˆãŒæ¬ ã‘ã€publish ãŒæ­¢ã¾ã‚‹ã€‚ã‚¿ã‚° push å‰ã« **å…¨ 6 ãƒ“ãƒ«ãƒ‰ãŒæˆåŠŸã—ã¦ã„ã‚‹**ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã€‚
- **èªè¨¼**: npm å…¬é–‹ã«ã¯ **NPM_TOKEN** ã¾ãŸã¯ Trusted Publisherï¼ˆOIDCï¼‰ãŒãƒªãƒã‚¸ãƒˆãƒªã«è¨­å®šã•ã‚Œã¦ã„ã‚‹å¿…è¦ãŒã‚ã‚‹ã€‚åˆå›žã‚„æ–°ã‚¹ã‚³ãƒ¼ãƒ—ã®å ´åˆã¯ [npm Trusted Publishers](https://docs.npmjs.com/generating-provenance-statements) ã®è¨­å®šã‚’ç¢ºèªã™ã‚‹ã€‚

### ãã®ä»–ã®ãƒ¯ãƒ¼ã‚¯ãƒ•ãƒ­ãƒ¼

- **bench.yml / benchmark-regression.yml / fuzz.yml / security.yml**: ãƒªãƒªãƒ¼ã‚¹ã® **ç›´æŽ¥ã®ã‚²ãƒ¼ãƒˆã«ã¯ãªã£ã¦ã„ãªã„**ã€‚CI.yml ã® build / test / publish ãŒé€šã‚Œã°ãƒªãƒªãƒ¼ã‚¹ã¯å¯èƒ½ã€‚å¿…è¦ã«å¿œã˜ã¦ãƒ™ãƒ³ãƒã‚„ã‚»ã‚­ãƒ¥ãƒªãƒ†ã‚£ãƒã‚§ãƒƒã‚¯ã‚‚å®Ÿè¡Œæ¸ˆã¿ã§ã‚ã‚‹ã“ã¨ã‚’ç¢ºèªã™ã‚‹ã¨ã‚ˆã„ã€‚

### ã‚³ãƒŸãƒƒãƒˆã«å«ã‚ãªã„ã‚‚ã®

- **npm/**ã€**\*.node**ã€**target/**ã€**node_modules/**ã€**artifacts/** ã¯ [.gitignore](../../.gitignore) ã§é™¤å¤–ã•ã‚Œã¦ã„ã‚‹ã€‚ãƒªãƒªãƒ¼ã‚¹ç”¨ã‚³ãƒŸãƒƒãƒˆã«ã“ã‚Œã‚‰ã‚’ add ã—ãªã„ã“ã¨ï¼ˆé€šå¸¸ã® `git add` ã§ã¯å…¥ã‚‰ãªã„ï¼‰ã€‚

### æŽ¨å¥¨æ‰‹é †ã®è¦ç´„ï¼ˆGit Flowï¼‰

1. develop ã‹ã‚‰ **release/v0.10.0** ã‚’åˆ‡ã‚‹ã€‚
2. release/v0.10.0 ä¸Šã§ **README.md** ã‚’ Performance & Trade-offs ã‚»ã‚¯ã‚·ãƒ§ãƒ³ï¼ˆè¡¨ãƒ»Which one / Philosophyï¼‰ã§æ›´æ–°ã—ã¦ã‚³ãƒŸãƒƒãƒˆã€‚
3. åŒãƒ–ãƒ©ãƒ³ãƒã§ **CHANGELOG** ã‚’ [0.10.0] ã«æ›´æ–°ï¼ˆæœ¬æ–‡ï¼‹æœ«å°¾ãƒªãƒ³ã‚¯ï¼‰ã—ã¦ã‚³ãƒŸãƒƒãƒˆã€‚
4. åŒãƒ–ãƒ©ãƒ³ãƒã§ `npm version 0.10.0 -m "Release v0.10.0"` å®Ÿè¡Œå¾Œã€**å¿…ãš `git status` ã§ Cargo.toml ã®å¤‰æ›´ã‚’ç¢ºèªã—ã€ã‚ã‚Œã° `git add Cargo.toml && git commit --amend --no-edit`**ã€‚
5. **main** ã« release/v0.10.0 ã‚’ãƒžãƒ¼ã‚¸ â†’ `git push origin main` â†’ `git push origin v0.10.0`ã€‚
6. **develop** ã« release/v0.10.0 ã‚’ãƒžãƒ¼ã‚¸ã—ã¦ pushã€‚

## ä½œæ¥­ãƒ•ãƒ­ãƒ¼æ¦‚è¦ï¼ˆGit Flowï¼‰

```mermaid
sequenceDiagram
  participant Dev as develop
  participant Release as release_v0.10.0
  participant Main as main
  participant CI as GitHub Actions
  participant NPM as npm registry

  Dev->>Release: checkout -b release/v0.10.0
  Release->>Release: README Performance and Trade-offs
  Release->>Release: CHANGELOG [0.10.0]
  Release->>Release: npm version 0.10.0 + Cargo.toml amend
  Release->>Main: merge release/v0.10.0
  Main->>Main: git push main + tag v0.10.0
  Main->>CI: push tag
  CI->>CI: build, test
  CI->>NPM: publish platform packages
  CI->>NPM: publish main package
  Main->>Dev: merge release/v0.10.0 into develop
```
